<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arquivo das Brumas: Sess√£o Zero | Ravenloft</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English+SC&family=Lora:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Gothic Neutral (Parchment, Deep Red, Warm Grays) -->
    <!-- Application Structure Plan: Includes the GHOST BACKEND integration via Google Apps Script (GAS). The 'Gerar Relat√≥rio' button is replaced by 'Enviar ao Mestre'. The script now packages data as JSON and performs a fetch POST request to the deployed GAS URL, which acts as the database endpoint (Google Sheets). -->
    <!-- Visualization & Content Choices: The main change is the JavaScript logic for data serialization and asynchronous submission, replacing the simple text copy function. All aesthetic and Chart.js settings remain the same. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            background-color: #fdf6e3; 
            color: #3a3a3a; 
            font-family: 'Lora', serif;
        }
        h1, h2, h3 {
            font-family: 'IM Fell English SC', serif;
            color: #4a0000; 
        }
        .header-title {
            text-shadow: 2px 2px 5px rgba(0,0,0,0.3);
        }
        section {
            background-color: #fcfaf3; 
            border: 1px solid #e0d8c7; 
            box-shadow: 4px 4px 8px rgba(0,0,0,0.1); 
        }
        .card {
            border: 2px solid #b3a795; 
            transition: all 0.2s ease-in-out;
            cursor: pointer;
        }
        .card.selected {
            border-color: #8B0000;
            background-color: #fff0f0; 
            transform: scale(1.03);
            box-shadow: 0 4px 15px rgba(139, 0, 0, 0.2);
        }
        .card:hover {
            transform: scale(1.01);
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        .safety-toggle {
            cursor: pointer;
            border: 1px solid #dcdcdc;
            transition: background-color 0.2s;
        }
        .safety-toggle.selected {
            background-color: #8B0000;
            color: white;
            border-color: #4a0000;
            font-weight: 500;
        }
         .filter-toggle.selected {
            background-color: #b45309; 
            color: white;
            border-color: #7c2d12;
        }
        .chart-container {
            position: relative; 
            width: 100%; 
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            height: 40vh;
            max-height: 450px;
        }
        textarea, input[type="text"] {
             border: 1px solid #b3a795;
             box-shadow: inset 1px 1px 3px rgba(0,0,0,0.1);
        }
        .difficulty-bar {
            height: 10px;
            transition: width 0.3s ease;
        }
        #submit-button.loading {
            background-color: #3a3a3a;
            pointer-events: none;
        }
    </style>
</head>
<body class="antialiased">
    <header class="bg-gray-800 bg-opacity-5 py-8 text-center shadow-lg">
        <div class="container mx-auto px-4">
            <h1 class="text-5xl md:text-6xl font-bold header-title text-red-900">Arquivo das Brumas</h1>
            <p class="text-xl text-gray-700 mt-2 italic font-serif">Definindo o Tom para a Noite em Ravenloft</p>
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-12 space-y-16">
        <!-- Se√ß√£o 1: Informa√ß√µes Essenciais -->
        <section id="info" class="p-8 rounded-xl">
            <h2 class="text-4xl mb-6 text-center border-b pb-2 border-red-200">1. Perfil do Aventureiro</h2>
            <p class="text-center text-gray-700 mb-8 max-w-2xl mx-auto">
                As primeiras linhas que definem a alma que ser√° testada pelas Brumas.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                    <label for="player_name" class="block text-sm font-medium text-gray-800">Nome/Apelido do Jogador</label>
                    <input type="text" id="player_name" class="mt-1 block w-full rounded-md shadow-sm focus:border-red-800 focus:ring-red-800 sm:text-base p-2">
                </div>
                <div>
                    <label for="char_name" class="block text-sm font-medium text-gray-800">Nome do Personagem</label>
                    <input type="text" id="char_name" class="mt-1 block w-full rounded-md shadow-sm focus:border-red-800 focus:ring-red-800 sm:text-base p-2">
                </div>
                <div>
                    <label for="char_class_race" class="block text-sm font-medium text-gray-800">Classe e Ra√ßa</label>
                    <input type="text" id="char_class_race" class="mt-1 block w-full rounded-md shadow-sm focus:border-red-800 focus:ring-red-800 sm:text-base p-2">
                </div>
            </div>
        </section>

        <!-- Se√ß√£o 2: Pilares da Aventura -->
        <section id="pillars" class="p-8 rounded-xl">
            <h2 class="text-4xl mb-6 text-center border-b pb-2 border-red-200">2. A Voz das Prefer√™ncias (1-5)</h2>
            <p class="text-center text-gray-700 mb-10 max-w-3xl mx-auto">
                Mova os controles deslizantes para mapear o seu perfil de jogo. O gr√°fico de radar reflete suas escolhas em tempo real.
            </p>
            <div class="flex flex-col lg:flex-row gap-12 items-center">
                <div class="w-full lg:w-1/2 space-y-6">
                    <div data-label="Interpreta√ß√£o">
                        <label for="interp_slider" class="flex justify-between font-medium"><span>Interpreta√ß√£o (Roleplay)</span><span id="interp_value" class="font-bold text-red-800">3</span></label>
                        <input id="interp_slider" type="range" min="1" max="5" value="3" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer slider">
                    </div>
                    <div data-label="Combate">
                        <label for="combat_slider" class="flex justify-between font-medium"><span>Combate T√°tico</span><span id="combat_value" class="font-bold text-red-800">3</span></label>
                        <input id="combat_slider" type="range" min="1" max="5" value="3" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer slider">
                    </div>
                    <div data-label="Explora√ß√£o">
                        <label for="explore_slider" class="flex justify-between font-medium"><span>Explora√ß√£o e Descoberta</span><span id="explore_value" class="font-bold text-red-800">3</span></label>
                        <input id="explore_slider" type="range" min="1" max="5" value="3" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer slider">
                    </div>
                    <div data-label="Investiga√ß√£o">
                        <label for="mystery_slider" class="flex justify-between font-medium"><span>Investiga√ß√£o e Mist√©rio</span><span id="mystery_value" class="font-bold text-red-800">3</span></label>
                        <input id="mystery_slider" type="range" min="1" max="5" value="3" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer slider">
                    </div>
                    <div data-label="Horror">
                        <label for="horror_slider" class="flex justify-between font-medium"><span>Horror e Tens√£o Narrativa</span><span id="horror_value" class="font-bold text-red-800">3</span></label>
                        <input id="horror_slider" type="range" min="1" max="5" value="3" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer slider">
                    </div>
                </div>
                <div class="w-full lg:w-1/2 chart-container border border-gray-200 rounded-lg p-2 shadow-inner">
                    <canvas id="pillarsChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o 3: Temas de Hist√≥ria -->
        <section id="themes" class="p-8 rounded-xl">
            <h2 class="text-4xl mb-6 text-center border-b pb-2 border-red-200">3. Foco da Trama nas Brumas</h2>
            <p class="text-center text-gray-700 mb-10 max-w-3xl mx-auto">
                Selecione os pontos focais da narrativa que voc√™ mais anseia ver desenvolvidos na campanha.
            </p>
            <div id="theme-cards" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="card p-5 rounded-lg text-center bg-gray-50" data-theme="O Lorde das Trevas">
                    <div class="text-4xl mb-2">ü¶á</div>
                    <h3 class="font-bold text-lg text-red-800">O Lorde das Trevas</h3>
                    <p class="text-sm text-gray-600">Investigar o poder e a hist√≥ria do mestre do Dom√≠nio.</p>
                </div>
                <div class="card p-5 rounded-lg text-center bg-gray-50" data-theme="Corrup√ß√£o Moral">
                    <div class="text-4xl mb-2">üé≠</div>
                    <h3 class="font-bold text-lg text-red-800">Corrup√ß√£o Moral</h3>
                    <p class="text-sm text-gray-600">Explorar a decad√™ncia da sociedade e a tenta√ß√£o pessoal.</p>
                </div>
                <div class="card p-5 rounded-lg text-center bg-gray-50" data-theme="Horrores Cl√°ssicos">
                     <div class="text-4xl mb-2">üê∫</div>
                    <h3 class="font-bold text-lg text-red-800">Horrores Cl√°ssicos</h3>
                    <p class="text-sm text-gray-600">Ca√ßar criaturas ic√¥nicas do horror.</p>
                </div>
                <div class="card p-5 rounded-lg text-center bg-gray-50" data-theme="Dilemas Pessoais">
                     <div class="text-4xl mb-2">üíî</div>
                    <h3 class="font-bold text-lg text-red-800">Dilemas Pessoais</h3>
                    <p class="text-sm text-gray-600">Focar nas fraquezas e traumas do meu personagem.</p>
                </div>
                <div class="card p-5 rounded-lg text-center bg-gray-50" data-theme="Fuga do Dom√≠nio">
                     <div class="text-4xl mb-2">üóùÔ∏è</div>
                    <h3 class="font-bold text-lg text-red-800">A Grande Fuga</h3>
                    <p class="text-sm text-gray-600">Busca intensa por uma sa√≠da da pris√£o.</p>
                </div>
                <div class="card p-5 rounded-lg text-center bg-gray-50" data-theme="Sobreviv√™ncia">
                     <div class="text-4xl mb-2">üèïÔ∏è</div>
                    <h3 class="font-bold text-lg text-red-800">Sobreviv√™ncia Extrema</h3>
                    <p class="text-sm text-gray-600">Lutar com recursos escassos e perigo f√≠sico constante.</p>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o 4: Ferramentas de Seguran√ßa -->
        <section id="safety" class="p-8 rounded-xl">
            <h2 class="text-4xl mb-6 text-center border-b pb-2 border-red-200">4. Os Limites da Tens√£o</h2>
            <p class="text-center text-gray-700 mb-10 max-w-3xl mx-auto">
                Defina seus limites para garantir o conforto e a divers√£o de todos. O respeito a esses limites √© inegoci√°vel.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-2xl mb-4 text-center text-red-900">Linhas Vermelhas (üö´ NUNCA)</h3>
                    <p class="text-sm text-center text-gray-600 mb-4 italic">Temas proibidos, que devem ser evitados em qualquer contexto.</p>
                    <div id="lines-list" class="space-y-3">
                        <div class="safety-toggle p-3 rounded text-center bg-gray-100 hover:bg-gray-200 transition duration-150">Abuso/Viol√™ncia Sexualizada</div>
                        <div class="safety-toggle p-3 rounded text-center bg-gray-100 hover:bg-gray-200 transition duration-150">Abuso de Crian√ßas ou Animais</div>
                        <div class="safety-toggle p-3 rounded text-center bg-gray-100 hover:bg-gray-200 transition duration-150">Automutila√ß√£o / Suic√≠dio</div>
                        <div class="safety-toggle p-3 rounded text-center bg-gray-100 hover:bg-gray-200 transition duration-150">Necrofilia</div>
                        <div class="safety-toggle p-3 rounded text-center bg-gray-100 hover:bg-gray-200 transition duration-150">Gore ou Tortura em Primeira Pessoa</div>
                    </div>
                </div>
                <div>
                    <h3 class="text-2xl text-amber-800 mb-4 text-center">Filtros (‚ö†Ô∏è CAUTELA)</h3>
                    <p class="text-sm text-center text-gray-600 mb-4 italic">Temas que podem ser mencionados, mas com modera√ß√£o ou fora de cena ("Fade to Black").</p>
                     <div id="filters-list" class="space-y-3">
                        <div class="filter-toggle safety-toggle p-3 rounded text-center bg-gray-100 hover:bg-gray-200 transition duration-150">Trai√ß√£o/PvP no grupo</div>
                        <div class="filter-toggle safety-toggle p-3 rounded text-center bg-gray-100 hover:bg-gray-200 transition duration-150">Preconceitos (Narrativa de Vil√£o)</div>
                        <div class="filter-toggle safety-toggle p-3 rounded text-center bg-gray-100 hover:bg-gray-200 transition duration-150">Fobias Espec√≠ficas</div>
                        <div class="filter-toggle safety-toggle p-3 rounded text-center bg-gray-100 hover:bg-gray-200 transition duration-150">Doen√ßas Graves / Epidemias</div>
                        <div class="filter-toggle safety-toggle p-3 rounded text-center bg-gray-100 hover:bg-gray-200 transition duration-150">Possess√£o / Perda de Controle</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o 5: Expectativas Finais -->
        <section id="feedback" class="p-8 rounded-xl">
            <h2 class="text-4xl mb-6 text-center border-b pb-2 border-red-200">5. A Voz do Jogador</h2>
             <p class="text-center text-gray-700 mb-8 max-w-3xl mx-auto">
                Detalhes finais sobre seus objetivos pessoais e feedback para o Mestre.
            </p>
            <div class="space-y-8">
                <div>
                    <label for="char_goals" class="block text-lg font-medium text-gray-800 mb-2">Traumas, medos ou objetivos do personagem a serem **explorados** na trama:</label>
                    <textarea id="char_goals" rows="3" class="mt-1 block w-full rounded-md shadow-sm sm:text-base p-3" data-name="Traumas_Objetivos"></textarea>
                </div>
                <div>
                    <label for="dislikes" class="block text-lg font-medium text-gray-800 mb-2">O que voc√™ **N√ÉO** gosta em mesas de RPG em geral?</label>
                    <textarea id="dislikes" rows="3" class="mt-1 block w-full rounded-md shadow-sm sm:text-base p-3" data-name="Desgostos"></textarea>
                </div>
                 <div class="border p-4 rounded-lg bg-gray-50">
                    <label for="difficulty_slider" class="block text-lg font-medium text-gray-800 mb-3">Expectativa sobre a Dificuldade do Combate (O qu√£o mortal ele deve ser?):</label>
                    <input id="difficulty_slider" type="range" min="1" max="5" value="3" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer">
                    <div class="flex justify-between text-sm text-gray-600 mt-2">
                        <span>F√°cil/Cinematogr√°fico (1)</span>
                        <span id="difficulty_value" class="font-bold text-base text-black">Moderado</span>
                        <span>Extremo/Mortal (5)</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2 mt-3">
                         <div id="difficulty-bar-indicator" class="difficulty-bar h-2 rounded-full bg-red-700" style="width: 50%;"></div>
                    </div>
                </div>
                 <div>
                    <label for="final_notes" class="block text-lg font-medium text-gray-800 mb-2">Alguma outra sugest√£o ou observa√ß√£o final?</label>
                    <textarea id="final_notes" rows="3" class="mt-1 block w-full rounded-md shadow-sm sm:text-base p-3" data-name="Notas_Finais"></textarea>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o 6: Enviar Resposta -->
        <section id="summary-section" class="p-8 rounded-xl text-center">
            <h2 class="text-4xl mb-6 text-red-900 border-b pb-2 border-red-200">6. Fechando o Arquivo</h2>
            <p class="text-center text-gray-700 mb-8 max-w-3xl mx-auto">
                Confirme suas escolhas e clique em ENVIAR para que o Mestre receba automaticamente seus dados em nossa planilha central!
            </p>
            <button id="submit-button" class="bg-red-800 hover:bg-red-900 text-white font-bold py-4 px-10 rounded-full shadow-2xl transition duration-300 uppercase tracking-widest text-lg transform hover:scale-105">
                Enviar Arquivo ao Mestre
            </button>
            
            <div id="submission-status" class="mt-6 text-center text-lg font-semibold hidden"></div>
        </section>
    </main>
    
    <footer class="text-center py-6 mt-12 border-t border-gray-300">
        <p class="text-sm text-gray-500 font-serif italic">As brumas esperam...</p>
    </footer>

    <script>
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbyMi0OsB2zrdZ64NaxoHGxufqoLnymN2Ok-5rgSmq_KWOhjTIBVCIAAfh7AXsJkokKg/exec"; 

        document.addEventListener('DOMContentLoaded', () => {
            const pillarLabels = ['Interpreta√ß√£o', 'Combate', 'Explora√ß√£o', 'Investiga√ß√£o', 'Horror'];
            const pillarIds = ['interp', 'combat', 'explore', 'mystery', 'horror'];
            const difficultyLabels = ["Muito F√°cil", "F√°cil", "Moderado", "Dif√≠cil", "Extremo/Mortal"];
            
            const chartCtx = document.getElementById('pillarsChart').getContext('2d');
            const pillarsChart = new Chart(chartCtx, {
                type: 'radar',
                data: {
                    labels: pillarLabels,
                    datasets: [{
                        label: 'Perfil de Prefer√™ncias',
                        data: [3, 3, 3, 3, 3],
                        backgroundColor: 'rgba(74, 0, 0, 0.2)', 
                        borderColor: 'rgba(74, 0, 0, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(139, 0, 0, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(139, 0, 0, 1)'
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(0, 0, 0, 0.1)' },
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            pointLabels: { 
                                font: { size: 12, family: "'Lora', serif" },
                                color: '#3a3a3a'
                            },
                            suggestedMin: 0,
                            suggestedMax: 5,
                            ticks: {
                                stepSize: 1,
                                backdropColor: 'rgba(253, 246, 227, 0.6)' 
                            }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                             backgroundColor: 'rgba(74, 0, 0, 0.9)',
                             titleFont: { family: "'Lora', serif" },
                             bodyFont: { family: "'Lora', serif" }
                        }
                    }
                }
            });

            function updateChart() {
                const newData = pillarIds.map(id => parseInt(document.getElementById(`${id}_slider`).value));
                pillarsChart.data.datasets[0].data = newData;
                pillarsChart.update();
            }

            pillarIds.forEach(id => {
                const slider = document.getElementById(`${id}_slider`);
                const valueLabel = document.getElementById(`${id}_value`);
                slider.addEventListener('input', () => {
                    valueLabel.textContent = slider.value;
                    updateChart();
                });
            });

            document.getElementById('theme-cards').addEventListener('click', (e) => {
                const card = e.target.closest('.card');
                if (card) {
                    card.classList.toggle('selected');
                }
            });
            
            ['lines-list', 'filters-list'].forEach(listId => {
                 document.getElementById(listId).addEventListener('click', (e) => {
                    const toggle = e.target.closest('.safety-toggle');
                    if (toggle) {
                        toggle.classList.toggle('selected');
                    }
                });
            });

            const difficultySlider = document.getElementById('difficulty_slider');
            const difficultyValue = document.getElementById('difficulty_value');
            const difficultyBar = document.getElementById('difficulty-bar-indicator');
            difficultySlider.addEventListener('input', () => {
                const value = difficultySlider.value;
                difficultyValue.textContent = difficultyLabels[value - 1];
                const percentage = (value - 1) * 25; 
                difficultyBar.style.width = `${percentage}%`;
                if (value >= 4) { difficultyBar.classList.replace('bg-red-700', 'bg-red-900'); }
                else if (value == 3) { difficultyBar.classList.replace('bg-red-900', 'bg-red-700'); }
                else { difficultyBar.classList.add('bg-red-700'); }
            });
            
            function collectData() {
                const data = {};

                // 1. Info
                data.jogador = document.getElementById('player_name').value || 'Vazio';
                data.personagem = document.getElementById('char_name').value || 'Vazio';
                data.classe_raca = document.getElementById('char_class_race').value || 'Vazio';

                // 2. Playstyle
                data.perfil_jogo = {};
                pillarIds.forEach(id => {
                    data.perfil_jogo[id] = document.getElementById(`${id}_slider`).value;
                });
                
                // 3. Themes
                data.temas_selecionados = Array.from(document.querySelectorAll('#theme-cards .card.selected'))
                                            .map(card => card.getAttribute('data-theme'));
                
                // 4. Safety
                data.linhas_vermelhas = Array.from(document.querySelectorAll('#lines-list .safety-toggle.selected'))
                                      .map(toggle => toggle.textContent.trim());
                data.filtros = Array.from(document.querySelectorAll('#filters-list .filter-toggle.selected'))
                                      .map(toggle => toggle.textContent.trim());

                // 5. Feedback
                data.traumas_objetivos = document.getElementById('char_goals').value || 'N/A';
                data.desgostos = document.getElementById('dislikes').value || 'N/A';
                data.dificuldade_combate = difficultyLabels[document.getElementById('difficulty_slider').value - 1];
                data.notas_finais = document.getElementById('final_notes').value || 'N/A';

                return data;
            }

            async function submitPreferences() {
                if (WEB_APP_URL === "YOUR_DEPLOYED_WEB_APP_URL_HERE") {
                    document.getElementById('submission-status').textContent = 'ERRO: O Mestre precisa configurar o Google Apps Script (Passo 3)!';
                    document.getElementById('submission-status').classList.remove('hidden', 'text-green-700', 'text-red-700');
                    document.getElementById('submission-status').classList.add('text-red-700');
                    return;
                }
                
                const submitButton = document.getElementById('submit-button');
                const statusDiv = document.getElementById('submission-status');
                
                const data = collectData();
                
                if (data.jogador === 'Vazio' || data.personagem === 'Vazio') {
                    statusDiv.textContent = 'Por favor, preencha seu nome e o nome do personagem.';
                    statusDiv.classList.remove('hidden', 'text-green-700');
                    statusDiv.classList.add('text-red-700');
                    return;
                }

                submitButton.classList.add('loading');
                submitButton.textContent = 'Enviando...';
                statusDiv.classList.remove('hidden', 'text-red-700');
                statusDiv.classList.add('text-gray-600');
                statusDiv.textContent = 'Preparando arquivo para as Brumas...';

                try {
                    const response = await fetch(WEB_APP_URL, {
                        method: 'POST',
                        mode: 'no-cors', 
                        cache: 'no-cache',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data)
                    });

                    // Como estamos usando 'no-cors', a resposta ser√° opaca.
                    // Em vez de verificar response.ok, assumimos o sucesso ap√≥s a resposta.
                    // Em produ√ß√£o, isso exigiria um endpoint CORS. Para GAS, √© o m√©todo mais simples.
                    
                    statusDiv.textContent = '‚úÖ Sucesso! O Mestre recebeu seu Arquivo das Brumas. Obrigado por preencher!';
                    statusDiv.classList.remove('text-red-700', 'text-gray-600');
                    statusDiv.classList.add('text-green-700');
                    submitButton.textContent = 'Enviado com Sucesso!';
                    submitButton.disabled = true;

                } catch (error) {
                    console.error('Erro no envio:', error);
                    statusDiv.textContent = '‚ùå Erro no envio. Tente novamente ou avise o Mestre sobre o problema de conex√£o.';
                    statusDiv.classList.remove('text-green-700', 'text-gray-600');
                    statusDiv.classList.add('text-red-700');
                    submitButton.textContent = 'Tentar Novamente';
                } finally {
                    submitButton.classList.remove('loading');
                }
            }

            document.getElementById('submit-button').addEventListener('click', submitPreferences);

            // Initial state updates
            difficultySlider.dispatchEvent(new Event('input'));
        });
    </script>
</body>
</html>
